require("data",function(n,r){function e(){return i(a,arguments)}function o(n){var r=[];return n.forEach(function(n){var e=n[0]>>8,o=e+".json";r.indexOf(o)<0&&r.push(o)}),r}function t(n,r){function e(){if(0==t.length)r(o);else{var n=t.pop();o[n]=null;var a=u.get(l+n);a.onsuccess=function(){var r=this.result,t=new FileReader;t.onload=function(){var a=t.result;try{o[n]=JSON.parse(a)}catch(n){console.error("Invalid JSON for file `"+r.name+"`!"),console.error(n)}e()},t.readAsText(r)},a.onerror=function(){console.error("Unable to load file `"+l+n+"`!"),console.error(this.error),e()}}}var o={},t=n.slice();e()}var a={en:{},fr:{}},i=require("$").intl,s=30;n.ERR_NO_NAVIGATOR=1,n.ERR_NO_DEVICE_STORAGE=2,n.ERR_UNAVAILABLE_DEVICE=3,n.ERR_SHARED_DEVICE=4,n.ERR_INDEX_NOT_FOUND=5,n.ERR_INVALID_INDEX=6;var c,l,u=null;n.countAreas=function(){return c.latlng.length/2},n.countPhotos=function(){return c.photos},n.getDate=function(){return c.date},n.loadPhotoDataURI=function(n){return new Promise(function(r,e){"function"!=typeof e&&(e=function(n){console.log(Error(n))});var o=u.get(l+n);o.onsuccess=function(){var n=this.result,e=new FileReader;e.onload=function(){var n=e.result;r(n)},e.readAsDataURL(n)},o.onerror=function(n){e(this.error)}})},n.init=function(r,e){function o(){if(i.length>0&&0==s){var n=i.pop();t(n)}else s?e(s):r()}function t(r){var o=r.available();o.onsuccess=function(){var o=this.result;switch(o){case"available":a(r);break;case"unavailable":e(n.ERR_UNAVAILABLE_DEVICE);break;case"shared":e(n.ERR_SHARED_DEVICE)}},o.onerror=function(){console.error(this.error)}}function a(o){l="/"+o.storageName+"/CampingCarAreas/";var t=l+"index.json",a=o.get(t);a.onsuccess=function(){var t=this.result,a=new FileReader;a.onload=function(){var t=a.result;try{c=JSON.parse(t)}catch(r){console.error(r),e(n.ERR_INVALID_INDEX)}u=o,r()},a.readAsText(t)},a.onerror=function(){console.error('Unable to get file "'+t+'"!'),console.error(this.error)}}if(navigator)if("function"==typeof navigator.getDeviceStorage){var i=navigator.getDeviceStorages("sdcard"),s=0;o()}else console.log("ERR_NO_DEVICE_STORAGE"),e(n.ERR_NO_DEVICE_STORAGE);else console.log("ERR_NO_NAVIGATOR"),e(n.ERR_NO_NAVIGATOR)},n.getType=function(n){return c.types[n]},n.distance=function(n,r,e,o){var t=6371,a=Math.PI*(e-n)/180,i=Math.PI*(o-r)/180,s=Math.sin(a/2)*Math.sin(a/2)+Math.cos(Math.PI*n/180)*Math.cos(Math.PI*e/180)*Math.sin(i/2)*Math.sin(i/2),c=2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s)),l=Math.floor(t*c*1e3);return l},n.find=function(r,e,a){r.coords&&(r={lat:r.coords.latitude,lng:r.coords.longitude}),console.info("[data] args=...",r);var i,l,u,f,E=[],h=r.lat,R=r.lng,d=r.radius,v=c.latlng;for("undefined"==typeof d&&(d=1e5),i=0;i<v.length;i+=2)l=v[i]/1e6,u=v[i+1]/1e6,f=n.distance(l,u,h,R),f<d&&E.push([i>>1,f]);E.sort(function(n,r){return n[1]-r[1]}),E.length>s&&(E=E.slice(0,s));var _=o(E);t(_,function(n){var r=[];E.forEach(function(e){var o,t,a=e[0],i=a>>8,s=255&a,c=n[i+".json"],l=e[1],u={$idx:a,$dis:l};for(o in c)t=c[o],u[o]=t[s];r.push(u)}),e(r)})},r.exports._=e});
//# sourceMappingURL=data.js.map